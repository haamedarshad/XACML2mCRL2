# XACML2mCRL2
*********************************************
The following shows a few XACML policies and corresponsing mCRL2 specifications generated by the latest version of XACML2mCRL2 (i.e., v1.2). 

**Example 1: XACML Policy**

```xml
<PolicySet xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="urn:oasis:names:tc:xacml:3.0:example:root" Version="1" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides" xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="urn:oasis:names:tc:xacml:3.0:example:Policy1" Version="1.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule1" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>			
			</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
	</Condition>
</Rule>
</Policy>
</PolicySet>
```
*********************************************
**Example 1: mCRL2 specifications**
```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct HealthData;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;

act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_Policy1(RS,RO,RA);	
			
	Policy_Policy1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule1(RS,RO,RA);
					
	Rule_Rule1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Permit);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);
```
***************************************
**Example 2: XACML Policy**
```xml

<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="urn:oasis:names:tc:xacml:3.0:example:root" Version="2.0" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="urn:oasis:names:tc:xacml:3.0:example:Policy1" Version="2.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule1" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule2" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
		<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
		</Apply>
	</Condition>
	<ObligationExpressions>
		<ObligationExpression FulfillOn="Permit" ObligationId="urn:oasis:names:tc:xacml:3.0:example:log">
		</ObligationExpression>
	</ObligationExpressions>
</Rule>
</Policy>
</PolicySet>
```
*********************************************
**Example 2: mCRL2 specifications**
```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct HealthData;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;
sort ObgID = struct log;
act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Obligation:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#ObgID;
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc			
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_Policy1(RS,RO,RA);	
			
	Policy_Policy1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule1(RS,RO,RA)
	+
	(
		(attribute(subjectid,Doctor) in RS) 
	)->	Rule_Rule2(RS,RO,RA);
					
	Rule_Rule1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_Rule2(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(actionid, Read) in RA)-> Obligation(RS,RO,RA,log).Response(RS,RO,RA,Permit);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);	
```
***************************************
**Example 3: XACML Policy**

```xml

<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="urn:oasis:names:tc:xacml:3.0:example:root" Version="2.0" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="urn:oasis:names:tc:xacml:3.0:example:Policy1" Version="2.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule1" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>			
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule3" Effect="Deny">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
	    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
		</Apply>
	</Condition>
</Rule>
</Policy>
</PolicySet>

```
************************************
**Example 3: mCRL2 specifications**

```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct HealthData;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;
act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc			
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_Policy1(RS,RO,RA);	
			
	Policy_Policy1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
										
	)-> Rule_Rule1(RS,RO,RA)
	+
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule3(RS,RO,RA);
					
	Rule_Rule1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_Rule3(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	!(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Deny);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);
	
```

**************************************
**Example 4: XACML Policy**

```xml
<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="urn:oasis:names:tc:xacml:3.0:example:root" Version="3.0" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="urn:oasis:names:tc:xacml:3.0:example:Policy1" Version="3.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule1" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule3" Effect="Deny">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
	    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>			
		</Apply>
		<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>	
		</Apply>
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule4" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>		
			</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">CareGiverA</AttributeValue>
			
		</Apply>
	</Condition>
</Rule>
</Policy>
</PolicySet>
  

```
*****************************************
**Example 4: mCRL2 specifications**

```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor|CareGiverA;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct HealthData;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;

act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc			
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_Policy1(RS,RO,RA);	
			
	Policy_Policy1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule1(RS,RO,RA)
	+
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
										
	)->	Rule_Rule3(RS,RO,RA)
	+
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule4(RS,RO,RA);

Rule_Rule1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Permit);
			
Rule_Rule3(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	!(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Deny);
			
Rule_Rule4(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, CareGiverA) in RS)-> Response(RS,RO,RA,Permit);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);

```

***************************************
**Example SOP: XACML Policy**

```xml
<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="root" Version="3.0" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="PolicySOP" Version="3.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "RuleA" Effect="Deny">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">MedicalRecords</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
	    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
		<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>		
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "RuleB" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">MedicalRecords</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
		<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		</Apply>
				<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">EmergencyStaff</AttributeValue>
		</Apply>
	</Condition>
</Rule>
</Policy>
</PolicySet>
  

```
*****************************************
**Example SOP: mCRL2 specifications**

```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor|EmergencyStaff;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct MedicalRecords;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;

act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc			
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_PolicySOP(RS,RO,RA);	
	
	Policy_PolicySOP(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(	
		(attribute(resourceid,MedicalRecords) in RO) 
	)->	Rule_RuleA(RS,RO,RA)
	+
	(	
		(attribute(resourceid,MedicalRecords) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_RuleB(RS,RO,RA);
					
	Rule_RuleA(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	!(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Deny);
			
	Rule_RuleB(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, EmergencyStaff) in RS)-> Response(RS,RO,RA,Permit);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);	
```

***************************************
**Example 6: XACML Policy**

**We have taken the following policy from https://github.com/nassirim/xacBench/tree/master/xacmltranslator**


```xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyCombiningAlgId="deny-overrides" PolicySetId="root_ps">
    <Target/>
    <Policy PolicyId="P1" RuleCombiningAlgId="permit-overrides">
        <Target/>
        <Rule Effect="Permit" RuleId="R1">
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file20</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read21</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file65</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read50</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                            </Apply>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P2" RuleCombiningAlgId="permit-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">write65</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record93</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Permit" RuleId="R2">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P3" RuleCombiningAlgId="deny-overrides">
        <Target/>
        <Rule Effect="Permit" RuleId="R3">
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiography81</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">write104</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiography26</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P4" RuleCombiningAlgId="deny-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read43</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Deny" RuleId="R4">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P5" RuleCombiningAlgId="permit-overrides">
        <Target/>
        <Rule Effect="Permit" RuleId="R5">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                            </Apply>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P6" RuleCombiningAlgId="permit-overrides">
        <Target/>
        <Rule Effect="Deny" RuleId="R6">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                            </Apply>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P7" RuleCombiningAlgId="permit-overrides">
        <Target/>
        <Rule Effect="Permit" RuleId="R7">
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read102</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record19</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read38</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P8" RuleCombiningAlgId="deny-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiography81</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">write104</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiography26</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Permit" RuleId="R8">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                            </Apply>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                        </Apply>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P9" RuleCombiningAlgId="permit-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read52</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiography34</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Permit" RuleId="R9">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P10" RuleCombiningAlgId="permit-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record107</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read41</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Permit" RuleId="R10">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P11" RuleCombiningAlgId="deny-overrides">
        <Target/>
        <Rule Effect="Permit" RuleId="R11">
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">write22</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">write3</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                            </Apply>
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P12" RuleCombiningAlgId="permit-overrides">
        <Target/>
        <Rule Effect="Permit" RuleId="R12">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                        </Apply>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P13" RuleCombiningAlgId="deny-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file21</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file22</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record80</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Deny" RuleId="R13">
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file21</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file22</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiography47</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record38</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P14" RuleCombiningAlgId="permit-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record71</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record118</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record25</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read93</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
						

                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Permit" RuleId="R14">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P15" RuleCombiningAlgId="deny-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">write5</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read9</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Permit" RuleId="R15">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Apply>
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                        </Apply>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P16" RuleCombiningAlgId="deny-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file20</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read21</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file65</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read50</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Permit" RuleId="R16">
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">write104</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiography26</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                        </Apply>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P17" RuleCombiningAlgId="permit-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read43</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Deny" RuleId="R17">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
    <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
</Apply>
<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                            </Apply>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P18" RuleCombiningAlgId="permit-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read28</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiography10</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Permit" RuleId="R18">
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record85</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">medical-file20</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read21</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                        </Apply>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P19" RuleCombiningAlgId="permit-overrides">
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-less-than-or-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record108</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">patient-record</AttributeValue>
                        <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule Effect="Permit" RuleId="R19">
            <Target/>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    <Policy PolicyId="P20" RuleCombiningAlgId="permit-overrides">
        <Target/>
        <Rule Effect="Permit" RuleId="R20">
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-greater-than">
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read55</AttributeValue>
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
                            <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:hospital" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                        </Apply>
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Val-de-Grace</AttributeValue>
                    </Apply>
                </Apply>
            </Condition>
            <ObligationExpressions>
                <ObligationExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">radiologist</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </ObligationExpression>
            </ObligationExpressions>
            <AdviceExpressions>
                <AdviceExpression>
                    <AttributeAssignmentExpression>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">administrator</AttributeValue>
                        </Apply>
                    </AttributeAssignmentExpression>
                </AdviceExpression>
            </AdviceExpressions>
        </Rule>
        <ObligationExpressions>
            <ObligationExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">clinical-researcher</AttributeValue>
                        </Apply>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-confidentiality" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">personal</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </ObligationExpression>
        </ObligationExpressions>
        <AdviceExpressions>
            <AdviceExpression>
                <AttributeAssignmentExpression>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
<AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:2.0:subject:location" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
                            </Apply>
                            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Europe</AttributeValue>
                        </Apply>
                    </Apply>
                </AttributeAssignmentExpression>
            </AdviceExpression>
        </AdviceExpressions>
    </Policy>
    
</PolicySet>

```
*****************************************
**Example 6: mCRL2 specifications**

**As you can see below, the obligation expressions are not translated into mCRL2. This is because the Obligation expressions that exist in the XACML policy do not include all the [Required] attributes and elements.** 

```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct hospital|role|location;
sort SAttValue = struct ValdeGrace|clinicalresearcher|radiologist|physician|Europe|administrator;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid|resourceconfidentiality;
sort OAttValue = struct 
				medicalfile20|
				medicalfile65|
				personal|
				patientrecord93|
				radiography81|
				radiography26|
				medicalfile|
				patientrecord19|
				radiography34|
				patientrecord107|
				medicalfile21|
				medicalfile22|
				patientrecord80|
				patientrecord|
				radiography47|
				patientrecord38|
				patientrecord71|
				patientrecord118|
				patientrecord25|
				radiography10|
				patientrecord85|
				patientrecord108;
		
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct read21|read50|write65|write104|read43|read102|read38|read52|read41|write22|write3|read93|write5|read9|read28|read55;
sort Decision = struct Permit | Deny;

act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc			
	PolicySet_root_ps(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = 
		Policy_P1(RS,RO,RA)
		+	
		(
			(
				(attribute(actionid,write65) in RA) 
				&&
				(attribute(resourceid,patientrecord93) in RO)
			)	
		)->	Policy_P2(RS,RO,RA)
		+	
		Policy_P3(RS,RO,RA)
		+	
		(
			(
				(attribute(actionid,read43) in RA)
			)	
		)-> Policy_P4(RS,RO,RA)
		+	
		Policy_P5(RS,RO,RA)
		+	
		Policy_P6(RS,RO,RA)
		+	
		Policy_P7(RS,RO,RA)
		+	
		(
			(
				(attribute(resourceid,radiography81) in RO)
			)	
			||
			(
				(attribute(actionid,write104) in RA) 
				&&
				(attribute(resourceid,radiography26) in RO)
			)	
		)->	Policy_P8(RS,RO,RA)
		+	
		(
			(
				(attribute(actionid,read52) in RA) 
				&&
				(attribute(resourceid,radiography34) in RO)
			)	
		)->	Policy_P9(RS,RO,RA)
		+	
		(
			(
				(attribute(resourceid,patientrecord107) in RO) 
				&&
				(attribute(actionid,read41) in RA)
			)	
				
		)->	Policy_P10(RS,RO,RA)
		+	
		Policy_P11(RS,RO,RA)
		+	
		Policy_P12(RS,RO,RA)
		+	
		(
			(
				(attribute(resourceid, medicalfile21) in RO) 
				&&
				(attribute(resourceid,medicalfile22) in RO)
			)	
			||
			(
				(attribute(resourceid,patientrecord80) in RO) 
				&&
				(attribute(resourceid,patientrecord) in RO)
			)	
		)->	Policy_P13(RS,RO,RA)
		+	
		(
			(
				(attribute(resourceid, patientrecord71) in RO) 
				&&
				(attribute(resourceid,patientrecord118) in RO)
			)	
			||
			(
				(attribute(resourceid,patientrecord25) in RO) 
				&&
				(attribute(actionid,read93) in RA)
			)	
		)->	Policy_P14(RS,RO,RA)
		+	
		(
			(
				(attribute(actionid,write5) in RA) 
				&&
				(attribute(actionid,read9) in RA)
			)	
		)->	Policy_P15(RS,RO,RA)
		+	
		(
			(
				(attribute(resourceid, medicalfile20) in RO) 
				&&
				(attribute(actionid,read21) in RA)
			)	
			||
			(
				(attribute(resourceid,medicalfile65) in RO) 
				&&
				(attribute(actionid,read50) in RA)
			)	
		)->	Policy_P16(RS,RO,RA)
		+	
		(
			(
				(attribute(actionid,read43) in RA)
			)	
		)->	Policy_P17(RS,RO,RA)
		+	
		(
			(
				(attribute(actionid,read28) in RA) 
				&&
				(attribute(resourceid,radiography10) in RO)
			)	
		)->	Policy_P18(RS,RO,RA)
		+	
		(
			(
				(attribute(resourceid,patientrecord108) in RO) 
				&&
				(attribute(resourceid,patientrecord) in RO)
			)	
		)->	Policy_P19(RS,RO,RA)
		+	
		Policy_P20(RS,RO,RA);	
			
	Policy_P1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
		(	
			(
				(attribute(resourceid,medicalfile20) in RO) 
				&&
				(attribute(actionid, read21) in RA) 
			)			
			||
			(
				(attribute(resourceid,medicalfile65) in RO) 
				&&
				(attribute(actionid,read50) in RA) 
			)		
		)->	Rule_R1(RS,RO,RA);
				
	Policy_P2(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	Rule_R2(RS,RO,RA);
				
	Policy_P3(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
		(	
			(
				(attribute(resourceid, radiography81) in RO) 
			)			
			||
			(
				(attribute(actionid,write104) in RA) 
				&&
				(attribute(resourceid,radiography26) in RO) 
			)		
		)->	Rule_R3(RS,RO,RA);
				
	Policy_P4(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	Rule_R4(RS,RO,RA);
				
	Policy_P5(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	Rule_R5(RS,RO,RA);
				
	Policy_P6(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	Rule_R6(RS,RO,RA);
				
	Policy_P7(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
		(	
			(
				(attribute(resourceid,medicalfile) in RO) 
				&&
				(attribute(actionid, read102) in RA) 
			)			
			||
			(
				(attribute(resourceid,patientrecord19) in RO) 
				&&
				(attribute(actionid,read38) in RA) 
			)		
		)->	Rule_R7(RS,RO,RA);
				
	Policy_P8(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	Rule_R8(RS,RO,RA);
				
	Policy_P9(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	Rule_R9(RS,RO,RA);
				
	Policy_P10(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))= Rule_R10(RS,RO,RA);
				
	Policy_P11(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
		(	
			(
				(attribute(actionid,write22) in RA) 
				&&
				(attribute(actionid,write3) in RA) 
			)		
		)->	Rule_R11(RS,RO,RA);
				
	Policy_P12(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))= Rule_R12(RS,RO,RA);
				
	Policy_P13(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
		(	
			(
				(attribute(resourceid,medicalfile21) in RO) 
				&&
				(attribute(resourceid, medicalfile22) in RO) 
			)			
			||
			(
				(attribute(resourceid,radiography47) in RO) 
				&&
				(attribute(resourceid,patientrecord38) in RO) 
			)		
		)->	Rule_R13(RS,RO,RA);
				
	Policy_P14(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))= Rule_R14(RS,RO,RA);
				
	Policy_P15(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))= Rule_R15(RS,RO,RA);
				
	Policy_P16(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
		(	
			(
				(attribute(actionid,write104) in RA) 
				&&
				(attribute(resourceid,radiography26) in RO)
			)		
		)->	Rule_R16(RS,RO,RA);
				
	Policy_P17(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))= Rule_R17(RS,RO,RA);
				
	Policy_P18(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
		(	
			(
				(attribute(resourceid, patientrecord85) in RO) 
			)			
			||
			(
				(attribute(resourceid,medicalfile20) in RO) 
				&&
				(attribute(actionid,read21) in RA) 
			)		
		)->	Rule_R18(RS,RO,RA);
				
	Policy_P19(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))= Rule_R19(RS,RO,RA);
				
	Policy_P20(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
		(	
			(
				(attribute(actionid,read55) in RA) 
			)		
		)->	Rule_R20(RS,RO,RA);
					
	Rule_R1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		!(attribute(hospital, ValdeGrace) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R2(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, radiologist) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R3(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(
			(attribute(role, clinicalresearcher) in RS) 
			&&
			(attribute(resourceconfidentiality, personal) in RO) 
		)-> Response(RS,RO,RA,Permit);
			
	Rule_R4(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, radiologist) in RS)-> Response(RS,RO,RA,Deny);
			
	Rule_R5(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, physician) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R6(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, physician) in RS)-> Response(RS,RO,RA,Deny);
			
	Rule_R7(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, radiologist) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R8(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, radiologist) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R9(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))= 
		!(attribute(hospital, ValdeGrace) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R10(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))= 
		!(attribute(location, Europe) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R11(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, physician) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R12(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, radiologist) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R13(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, administrator) in RS)-> Response(RS,RO,RA,Deny);
			
	Rule_R14(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		!(attribute(hospital, ValdeGrace) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R15(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(attribute(role, radiologist) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R16(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(
			(attribute(role, clinicalresearcher) in RS) 
			&&
			(attribute(resourceconfidentiality, personal) in RO) 
		)-> Response(RS,RO,RA,Permit);
			
	Rule_R17(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		!(attribute(location, Europe) in RS)-> Response(RS,RO,RA,Deny);
			
	Rule_R18(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		!(attribute(hospital, ValdeGrace) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_R19(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		(
			(attribute(role, clinicalresearcher) in RS) 
			&&
			(attribute(resourceconfidentiality, personal) in RO) 
		)-> Response(RS,RO,RA,Permit);
			
	Rule_R20(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
		!(attribute(hospital, ValdeGrace) in RS)-> Response(RS,RO,RA,Permit);
		
init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root_ps(RS,RO,RA);

```

***************************************
