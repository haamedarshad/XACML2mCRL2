# XACML2mCRL2
*********************************************
The following shows a few XACML policies and corresponsing mCRL2 specifications generated by the latest version of XACML2mCRL2 (i.e., v1.2). 

**Example 1: XACML Policy**

```xml
<PolicySet xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="urn:oasis:names:tc:xacml:3.0:example:root" Version="1" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides" xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="urn:oasis:names:tc:xacml:3.0:example:Policy1" Version="1.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule1" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>			
			</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
	</Condition>
</Rule>
</Policy>
</PolicySet>
```
*********************************************
**Example 1: mCRL2 specifications**
```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct HealthData;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;

act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_Policy1(RS,RO,RA);	
			
	Policy_Policy1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule1(RS,RO,RA);
					
	Rule_Rule1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Permit);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);
```
***************************************
**Example 2: XACML Policy**
```xml

<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="urn:oasis:names:tc:xacml:3.0:example:root" Version="2.0" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="urn:oasis:names:tc:xacml:3.0:example:Policy1" Version="2.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule1" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule2" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
		<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
		</Apply>
	</Condition>
	<ObligationExpressions>
		<ObligationExpression FulfillOn="Permit" ObligationId="urn:oasis:names:tc:xacml:3.0:example:log">
		</ObligationExpression>
	</ObligationExpressions>
</Rule>
</Policy>
</PolicySet>
```
*********************************************
**Example 2: mCRL2 specifications**
```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct HealthData;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;
sort ObgID = struct log;
act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Obligation:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#ObgID;
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc			
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_Policy1(RS,RO,RA);	
			
	Policy_Policy1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule1(RS,RO,RA)
	+
	(
		(attribute(subjectid,Doctor) in RS) 
	)->	Rule_Rule2(RS,RO,RA);
					
	Rule_Rule1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_Rule2(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(actionid, Read) in RA)-> Obligation(RS,RO,RA,log).Response(RS,RO,RA,Permit);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);	
```
***************************************
** Example 3: XACML Policy **

```xml

<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="urn:oasis:names:tc:xacml:3.0:example:root" Version="2.0" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="urn:oasis:names:tc:xacml:3.0:example:Policy1" Version="2.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule1" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>			
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule3" Effect="Deny">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
	    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
		</Apply>
	</Condition>
</Rule>
</Policy>
</PolicySet>

```
************************************
** Example 3: mCRL2 specifications **

```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct HealthData;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;
act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc			
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_Policy1(RS,RO,RA);	
			
	Policy_Policy1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
										
	)-> Rule_Rule1(RS,RO,RA)
	+
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule3(RS,RO,RA);
					
	Rule_Rule1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Permit);
			
	Rule_Rule3(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	!(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Deny);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);
	
```

**************************************
** Example 4: XACML Policy **

```xml
<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="urn:oasis:names:tc:xacml:3.0:example:root" Version="3.0" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="urn:oasis:names:tc:xacml:3.0:example:Policy1" Version="3.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule1" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>	
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule3" Effect="Deny">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
	    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>			
		</Apply>
		<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>	
		</Apply>
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "urn:oasis:names:tc:xacml:3.0:example:ruleid:Rule4" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">HealthData</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
			<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>		
			</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">CareGiverA</AttributeValue>
			
		</Apply>
	</Condition>
</Rule>
</Policy>
</PolicySet>
  

```
*****************************************
** Example 4: mCRL2 specifications**

```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor|CareGiverA;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct HealthData;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;

act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc			
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_Policy1(RS,RO,RA);	
			
	Policy_Policy1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule1(RS,RO,RA)
	+
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
										
	)->	Rule_Rule3(RS,RO,RA)
	+
	(	
		(attribute(resourceid,HealthData) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_Rule4(RS,RO,RA);

Rule_Rule1(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Permit);
			
Rule_Rule3(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	!(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Deny);
			
Rule_Rule4(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, CareGiverA) in RS)-> Response(RS,RO,RA,Permit);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);

```

***************************************
** Example SOP: XACML Policy **

```xml
<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicySetId="root" Version="3.0" PolicyCombiningAlgId="urn:oasis:names:tc:xacml:3.0:policy-combining-algorithm:permit-overrides">
<Target/>
<Policy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd" PolicyId="PolicySOP" Version="3.0" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:permit-overrides">
<Target/>
<Rule RuleId= "RuleA" Effect="Deny">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">MedicalRecords</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
	    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:not">
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
		<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>		
		</Apply>
			<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Doctor</AttributeValue>
		</Apply>
		</Apply>
	</Condition>
</Rule>
<Rule RuleId= "RuleB" Effect="Permit">
	<Target>
		<AnyOf>
			<AllOf>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">MedicalRecords</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" AttributeId="resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>					
				</Match>
				<Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Read</AttributeValue>
					<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" AttributeId="action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</Match>
			</AllOf>
		</AnyOf>
	</Target>
	<Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
		<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
		<AttributeDesignator MustBePresent="false" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
		</Apply>
				<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">EmergencyStaff</AttributeValue>
		</Apply>
	</Condition>
</Rule>
</Policy>
</PolicySet>
  

```
*****************************************
** Example SOP: mCRL2 specifications **

```
sort SAtt = struct attribute(name:SAttName, value:SAttValue);
sort SAttName = struct subjectid;
sort SAttValue = struct Doctor|EmergencyStaff;
sort OAtt = struct attribute(name:OAttName, value:OAttValue);
sort OAttName = struct resourceid;
sort OAttValue = struct MedicalRecords;
sort AAtt = struct attribute(name:AAttName, value:AAttValue);
sort AAttName = struct actionid;
sort AAttValue = struct Read;
sort Decision = struct Permit | Deny;

act
	Request:FSet(SAtt)#FSet(OAtt)#FSet(AAtt);
	Response:FSet(SAtt)#FSet(OAtt)#FSet(AAtt)#Decision;

proc			
	PolicySet_root(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt)) = Policy_PolicySOP(RS,RO,RA);	
	
	Policy_PolicySOP(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=	
	(	
		(attribute(resourceid,MedicalRecords) in RO) 
	)->	Rule_RuleA(RS,RO,RA)
	+
	(	
		(attribute(resourceid,MedicalRecords) in RO) 
		&&
		(attribute(actionid,Read) in RA) 
	)->	Rule_RuleB(RS,RO,RA);
					
	Rule_RuleA(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	!(attribute(subjectid, Doctor) in RS)-> Response(RS,RO,RA,Deny);
			
	Rule_RuleB(RS:FSet(SAtt), RO:FSet(OAtt), RA:FSet(AAtt))=
	(attribute(subjectid, EmergencyStaff) in RS)-> Response(RS,RO,RA,Permit);

init sum RS:FSet(SAtt).sum RO:FSet(OAtt).sum RA:FSet(AAtt).(RS !={} && RO !={} && RA !={})-> Request(RS,RO,RA).PolicySet_root(RS,RO,RA);	
```

***************************************